
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:sans-serif;
}

/* ===== TOP AD ===== */
#ad-top{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:50px;
  z-index:9999;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#000;
}

/* ===== FEED ===== */
.feed{
  height:100%;
  overflow-y:scroll;
  scroll-snap-type:y mandatory;
  -webkit-overflow-scrolling:touch;
  padding-top:50px;
}

.item{
  height:100%;
  position:relative;
  scroll-snap-align:start;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
  background:#000;
}

/* USER INFO */
.user-box{
  position:absolute;
  bottom:20px;
  left:12px;
  display:flex;
  align-items:center;
  gap:8px;
  color:#fff;
  font-size:13px;
}

.avatar{
  width:36px;
  height:36px;
  border-radius:50%;
  border:2px solid #fff;
}

/* ACTIONS */
.actions{
  position:absolute;
  right:12px;
  bottom:80px;
  display:flex;
  flex-direction:column;
  gap:18px;
  color:#fff;
  font-size:22px;
  text-align:center;
}

.actions div{
  cursor:pointer;
  user-select:none;
}

.actions .liked{
  color:#ff2d55;
}

.count{
  font-size:12px;
  opacity:.8;
}

/* SOUND */
.sound{
  position:absolute;
  top:20px;
  right:20px;
  font-size:22px;
  background:rgba(0,0,0,.5);
  padding:8px;
  border-radius:50%;
  cursor:pointer;
}
</style>
</head>
<body>

<!-- ===== IKLAN ATAS ===== -->
<div id="ad-top">
  <script>
    atOptions = {
      key : 'a56d9957870f34de53762968bb2255c5',
      format : 'iframe',
      height : 50,
      width : 320,
      params : {}
    };
  </script>
  <script src="https://situateddivine.com/a56d9957870f34de53762968bb2255c5/invoke.js"></script>
</div>

<div class="feed" id="feed"></div>

<script>
let currentVideo = null;
let scrollLocked = false;

/* ===== TOGGLE SOUND ===== */
function toggleSound(btn){
  const video = btn.closest(".item").querySelector("video");
  video.muted = !video.muted;
  btn.textContent = video.muted ? "üîá" : "üîä";
}

/* ===== LIKE ===== */
function like(el){
  el.classList.toggle("liked");
  const c = el.querySelector(".count");
  let n = parseInt(c.textContent);
  c.textContent = el.classList.contains("liked") ? n+1 : n-1;
}

/* ===== SCROLL LOCK ===== */
function lockScroll(){
  scrollLocked = true;
  setTimeout(()=>scrollLocked=false, 500);
}

const feed = document.getElementById("feed");
feed.addEventListener("wheel",e=>{
  if(scrollLocked) e.preventDefault();
},{passive:false});

feed.addEventListener("touchmove",e=>{
  if(scrollLocked) e.preventDefault();
},{passive:false});

/* ===== LOAD VIDEO LIST ===== */
const list = JSON.parse(localStorage.getItem("VIDEO_LIST")) || [];
const start = parseInt(localStorage.getItem("START_INDEX")) || 0;

if(!list.length){
  location.href="index.html";
}

const ordered = [...list.slice(start), ...list.slice(0,start)];

/* ===== BUILD FEED ===== */
ordered.forEach(v=>{
  const likes = Math.floor(Math.random()*900)+100;
  const comments = Math.floor(Math.random()*300)+20;
  const avatar = `https://i.pravatar.cc/150?u=${v.user}`;

  const d = document.createElement("div");
  d.className = "item";
  d.innerHTML = `
    <video src="${v.src}" muted loop playsinline preload="metadata"></video>

    <div class="sound" onclick="toggleSound(this)">üîá</div>

    <div class="user-box">
      <img class="avatar" src="${avatar}">
      <div>@${v.user}</div>
    </div>

    <div class="actions">
      <div onclick="like(this)">
        ‚ù§Ô∏è
        <div class="count">${likes}</div>
      </div>
      <div onclick="alert('Komentar coming soon')">
        üí¨
        <div class="count">${comments}</div>
      </div>
    </div>
  `;
  feed.appendChild(d);
});

/* ===== OBSERVER ===== */
const observer = new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    const video = e.target.querySelector("video");
    const soundBtn = e.target.querySelector(".sound");

    if(e.isIntersecting){
      lockScroll();

      if(currentVideo && currentVideo !== video){
        currentVideo.pause();
        currentVideo.currentTime = 0;
        currentVideo.muted = true;
      }

      currentVideo = video;
      video.play().catch(()=>{});
      soundBtn.textContent = video.muted ? "üîá" : "üîä";
    }else{
      video.pause();
    }
  });
},{threshold:0.75});

document.querySelectorAll(".item").forEach(i=>observer.observe(i));
</script>

<script src="https://situateddivine.com/b8/1f/13/b81f134cc26510fc67813f6dca90178f.js"></script>

<!-- ===== HISTATS ===== -->
<script>
var _Hasync=_Hasync||[];
_Hasync.push(['Histats.start','1,4992245,4,511,95,18,00000000']);
_Hasync.push(['Histats.fasi','1']);
_Hasync.push(['Histats.track_hits','']);
(function(){
  var hs=document.createElement('script');
  hs.async=true;
  hs.src='//s10.histats.com/js15_as.js';
  document.body.appendChild(hs);
})();
</script>
<noscript>
<a href="/" target="_blank">
<img src="//sstatic1.histats.com/0.gif?4992245&101" border="0">
</a>
</noscript>

</body>
</html>
